<!DOCTYPE html>
<html>
<head>
  <!-- Vega & Vega-Lite -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>

  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">

  <style>
    :root {
      --card-max-width: 540px;
      --col-gap: 48px;
      --row-gap: 80px;       /* global grid row spacing */
      --title-tighten: 14px; /* how much to pull charts/titles upward when 'tight-above' is used */
      --gap-below-header: 48px;

      /* Footer colors */
      --footer-bg: #243447;
      --footer-fg: #e5eff7;
      --footer-accent: #60a5fa;

      /* NEW: shared page width so footer aligns with dashboard tiles */
      --page-max: calc(var(--card-max-width) * 2 + var(--col-gap));
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Arial, Roboto, Helvetica, Arial;
      background-color: #f5f5f5;
      color: #0b1622;
    }

    .main-header {
      background: linear-gradient(90deg, #0b1622, #121e33);
      color: #ffffff;
      text-align: center;
      padding: 40px 20px;
      font-family: "Georgia", "Times New Roman", serif;
      font-weight: 700;
      font-size: 42px;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
      border-bottom: 3px solid #1e3a8a;
    }

    .dashboard {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      column-gap: var(--col-gap);
      row-gap: var(--row-gap);
      max-width: var(--page-max);             /* ‚Üê shared with footer */
      margin: 0 auto 48px;
      padding: var(--gap-below-header) 12px 24px; /* 24px matches footer inner padding */
      align-items: start;
    }
    @media (max-width:1100px){
      .dashboard { grid-template-columns:1fr; max-width: var(--card-max-width); }
    }

    /* ===== KPI / STAT CARDS ===== */
    .stats {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 22px;
    }
    @media (max-width: 900px) { .stats { grid-template-columns: 1fr; } }

    .stat-card {
      background: #fff;
      border-radius: 14px;
      padding: 22px 22px 18px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.06);
      border-left: 6px solid transparent;
    }
    .accent-blue   { border-left-color: #3b82f6; }
    .accent-amber  { border-left-color: #f59e0b; }
    .accent-purple { border-left-color: #8b5cf6; }

    .stat-value { font-weight: 800; font-size: 34px; color: #0f172a; letter-spacing: .3px; line-height: 1; margin-bottom: 8px; }
    .stat-label { display: flex; align-items: center; gap: 8px; text-transform: uppercase; font-size: 12.5px; letter-spacing: 1px; color: #475569; }
    .stat-emoji { font-size: 16px; line-height: 1; opacity: .9; }

    /* ===== Titles & Tiles ===== */
    .row-title {
      grid-column:1 / -1;
      margin:6px 2px 0;
      font-size:25px;
      line-height:1.3;
      color:#111;
      font-weight:700;
      text-align:center;
    }

    .tight-above { margin-top: calc(-1 * var(--title-tighten)); }

    .tile {
      display:flex;
      flex-direction:column;
      max-width: var(--card-max-width);
      width:100%;
      margin:0 auto;
    }

    .tile--full {
      grid-column: 1 / -1;
      max-width: none;
      width: 100%;
    }

    .chart {
      background:#fff;
      border-radius:10px;
      box-shadow:0 1px 3px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04);
      padding:10px;
      overflow:hidden;
    }

    .chart .vega-embed,
    .chart .vega-embed > svg,
    .chart .vega-embed svg {
      width:100% !important;
      height:auto !important;
      max-width:100% !important;
      display:block;
    }

    .caption {
      background-color: #f9fafb;
      border-left: 4px solid #3b82f6;
      border-radius: 6px;
      padding: 10px 14px;
      margin: 12px 2px 0;
      font-size: 16px;
      line-height: 1.5;
      color: #333;
      font-style: italic;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }

    /* ===== Footer ===== */
    .site-footer{
      background: var(--footer-bg);
      color: var(--footer-fg);
      margin-top: 56px;
      padding: 28px 0 36px;     /* no side padding here; use inner for alignment */
      text-align: left;
      border-top: 4px solid rgba(255,255,255,0.06);
    }
    .footer-inner{
      max-width: var(--page-max); /* ‚Üê same width as dashboard */
      margin: 0 auto;
      padding: 0 24px;            /* ‚Üê same side padding as .dashboard */
    }
    @media (max-width:1100px){
      .footer-inner { max-width: var(--card-max-width); }
    }
    .site-footer h3{
      margin: 0 0 12px;
      font-size: 18px;
      color: #ffffff;
    }
    .site-footer p{
      margin: 0 0 14px;
      font-size: 15px;
    }
    .source-list{
      display: block;
      text-align: left;
      margin: 0;
      padding: 0;
      list-style: none;
      line-height: 1.6;
      font-size: 15px;
    }
    .source-list li{ margin: 4px 0; }
    .site-footer a{
      color: var(--footer-accent);
      text-decoration: none;
      word-break: break-all;
    }
    .site-footer a:hover{ text-decoration: underline; }
    .credit{
      font-weight: 600;
      color: #ffffff;
    }
  </style>
</head>

<body>

  <div class="main-header">
    Healthcare Access and Disease Trends in Malaysia
  </div>

  <div class="dashboard">

    <!-- KPI / STAT CARDS -->
    <div class="stats" role="group" aria-label="Summary statistics">
      <div class="stat-card accent-blue" aria-label="Territories Covered">
        <div class="stat-value">16</div>
        <div class="stat-label"><span class="stat-emoji">üó∫Ô∏è</span> Territories Covered</div>
      </div>

      <div class="stat-card accent-amber" aria-label="Diseases Tracked">
        <div class="stat-value">11</div>
        <div class="stat-label"><span class="stat-emoji">üß™</span> Diseases Tracked</div>
      </div>

      <div class="stat-card accent-purple" aria-label="Year Coverage">
        <div class="stat-value">20</div>
        <div class="stat-label"><span class="stat-emoji">üìÖ</span> Year Coverage</div>
      </div>
    </div>

    <!-- Row title BEFORE the first full-width chart -->
    <h2 class="row-title tight-above">Detailed Analysis of Malaysia's Healthcare Accessibility</h2>

    <div class="tile tile--full tight-above">
      <div id="choropleth_full" class="chart"></div>
      <p class="caption">
        Healthcare staff distribution varies widely across Malaysia, with <strong>stronger coverage</strong> in smaller territories and <strong>lower ratios</strong> in large, populous states, revealing significant <strong>regional healthcare disparities</strong>.
      </p>
    </div>

    <!-- Two-column row -->
    <div class="tile tight-above">
      <div id="hospital_bed_stacked_bar" class="chart"></div>
      <p class="caption">
        <strong>Total capacity rose 11%</strong> since 2015, with <strong>MOH hospitals</strong> remaining ~80% share. Growth peaked in 2020‚Äì2021; <strong>special institutions</strong> surged in 2020, then plateaued while non-MOH hospitals expanded.
      </p>
    </div>

    <div class="tile tight-above">
      <div id="hospital_bumpchart" class="chart"></div>
      <p class="caption">
        <strong>Selangor</strong> dominates throughout, with <strong>Kuala Lumpur</strong> consistently second. From 2020 to 2021, <strong>Johor surges</strong> to 37 facilities, Sabah and Putrajaya trend upward while Labuan remains zero.
      </p>
    </div>

    <h2 class="row-title">Diving Deep Into Infectious Disease Trends & Changes in Malaysia</h2>

    <div class="tile tile--full tight-above">
      <div id="dengue_psm_full" class="chart"></div>
      <p class="caption">
        <strong>Dengue</strong> cases surged in 2014‚Äì2015 and 2019, with <strong>Selangor</strong> dominating totals. Penang, Perak and Johor also show large <strong>outbreaks</strong>, while Sabah and Sarawak cases rose in 2010.
      </p>
    </div>

    <!-- Two-column row -->
    <div class="tile tight-above">
      <div id="bubble_plot" class="chart"></div>
      <p class="caption">
        <strong>Food poisoning</strong> far outweighs others, peaking 2014‚Äì2016; incidence declines after 2016 with troughs in 2020‚Äì2021. <strong>Cholera</strong> spikes early then collapses; dysentery and typhoid remain low.
      </p>
    </div>

    <div class="tile tight-above">
      <div id="std_dumbbell" class="chart"></div>
      <p class="caption">
        <strong>AIDS</strong> rates rebounded in 2022 after earlier decline, with sharp rises in Sarawak and Johor. <strong>Syphilis</strong> cases surged nationwide, especially in <strong>Selangor</strong> and Pulau Pinang.
      </p>
    </div>
  </div>

  <!-- ====== FOOTER (aligned with dashboard) ====== -->
  <footer class="site-footer" role="contentinfo">
    <div class="footer-inner">
      <p>Designed and created by <span class="credit">Somkiet Phromsuwan</span> on 21/10/2025</p>

      <h3>Data Sources:</h3>
      <ul class="source-list">
        <li>Data.gov.my: <a href="https://archive.data.gov.my/data/en_US/dataset/number-of-cases-and-incidence-rate-per-100000-population-of-communicable-diseases-malaysia/resource/5c371141-810e-4588-ac03-5a46a88e01a4#content">https://archive.data.gov.my/.../5c371141-810e-4588-ac03-5a46a88e01a4#content</a></li>
        <li>Data.gov.my: <a href="https://archive.data.gov.my/data/en_US/dataset/number-of-private-hospitals-nursing-and-maternity-homes-and-beds-by-state-malaysia/resource/33fe894f-389b-45d6-9f5c-050eff368e32">https://archive.data.gov.my/.../33fe894f-389b-45d6-9f5c-050eff368e32</a></li>
        <li>Data.gov.my: <a href="https://data.gov.my/data-catalogue/std_state">https://data.gov.my/data-catalogue/std_state</a></li>
        <li>Data.gov.my: <a href="https://data.gov.my/data-catalogue/hospital_beds">https://data.gov.my/data-catalogue/hospital_beds</a></li>
        <li>Mendeley Data: <a href="https://data.mendeley.com/datasets/r3k8rxg2cw/1">https://data.mendeley.com/datasets/r3k8rxg2cw/1</a></li>
      </ul>
    </div>
  </footer>

  <script>
    // Specs
    const specChoroplethFull = "healthcare_staff_choropleth_map.vg.json";
    const specHospBedsStacked = "hospital_bed_stacked_bar_chart.vg.json";
    const specBumpChart = "hospital_facilities_bumpchart.vg.json";
    const specDenguePSMFull = "dengue_proportional_symbol_map.vg.json";
    const specBubble = "infectious_disease_bubble_plot.vg.json";
    const specDumbbell = "std_dumbell_chart.vg.json";

    const baseOpt = { actions:false, renderer:"svg" };

    const optWithHeight = (h) => ({
      ...baseOpt,
      patch: (spec) => ({
        ...spec,
        width: "container",
        height: h,
        autosize: { type: "fit", contains: "padding" }
      })
    });

    // Embeds
    vegaEmbed("#choropleth_full",  specChoroplethFull,  optWithHeight(460)).catch(console.error);
    vegaEmbed("#hospital_bed_stacked_bar", specHospBedsStacked, optWithHeight(420)).catch(console.error);
    vegaEmbed("#hospital_bumpchart",       specBumpChart,       optWithHeight(420)).catch(console.error);
    vegaEmbed("#dengue_psm_full",          specDenguePSMFull,   optWithHeight(740)).catch(console.error);
    vegaEmbed("#bubble_plot",               specBubble,          optWithHeight(485)).catch(console.error);
    vegaEmbed("#std_dumbbell",              specDumbbell,        optWithHeight(420)).catch(console.error);
  </script>

</body>
</html>
